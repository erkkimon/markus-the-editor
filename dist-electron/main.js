"use strict";const{app:s,BrowserWindow:p,ipcMain:r,dialog:c}=require("electron"),d=require("path"),w=require("electron-is-dev"),{readFileSync:f,writeFileSync:u,watch:m}=require("fs");let o=null,t=null;function h(){const n=new p({width:800,height:600,webPreferences:{preload:d.join(__dirname,"../dist/preload.js"),nodeIntegration:!1,contextIsolation:!0}});return n.loadURL(w?process.env.VITE_DEV_SERVER_URL:`file://${d.join(__dirname,"../dist/index.html")}`),w&&n.webContents.openDevTools(),n.on("closed",()=>{t=null,o&&o.close()}),n}s.whenReady().then(()=>{t=h(),r.handle("dialog:openFile",async()=>{const{canceled:n,filePaths:i}=await c.showOpenDialog({properties:["openFile"],filters:[{name:"Markdown Files",extensions:["md"]}]});if(n)return null;{const e=i[0],a=f(e,"utf-8");return o&&o.close(),o=m(e,l=>{if(l==="change"&&t){const g=f(e,"utf-8");t.webContents.send("file-changed",{filePath:e,content:g})}}),{filePath:e,content:a}}}),r.handle("dialog:saveFile",async(n,{filePath:i,content:e})=>{if(i)return u(i,e),i;{const{canceled:a,filePath:l}=await c.showSaveDialog({filters:[{name:"Markdown Files",extensions:["md"]}]});return a?null:(u(l,e),l)}}),s.on("activate",()=>{p.getAllWindows().length===0&&(t=h())})});s.on("window-all-closed",()=>{process.platform!=="darwin"&&s.quit()});
